Да, вы правы! В случае ошибки не будет вызван блок .doOnSuccess(response -> log.info("Запрос выполнен успешно: {}", response)), потому что он выполняется только в случае успешного ответа от сервера.

Вот подробное объяснение:

retrieve(): Этот метод инициирует выполнение запроса и возвращает объект ResponseSpec, с которым можно работать для обработки успешных ответов или ошибок.

onStatus(HttpStatus::isError, response -> {...}):

Если сервер вернул ошибку (например, статус 4xx или 5xx), то этот блок срабатывает.
В нем вы можете обработать ошибку (например, десериализовать тело ошибки, логировать ее и выбросить исключение).
Если произошла ошибка (например, из-за статуса 4xx или 5xx):

Мы не перейдем в doOnSuccess, потому что retrieve() не возвращает успешный результат (например, 2xx код). Вместо этого будет выполнен блок в onStatus.
bodyToMono(DepositResponse.class) не будет вызван, потому что запрос завершится ошибкой, и выполнение сразу пойдет в блок onStatus, где обработка ошибки завершится выбросом исключения через Mono.error(...) или другими действиями.
В случае ошибки весь поток (с точки зрения реактивного программирования) будет прерван, и дальнейшая обработка не будет продолжаться.

В случае успешного ответа (например, код 2xx):

Мы попадем в метод .bodyToMono(DepositResponse.class) для десериализации успешного ответа в объект DepositResponse.
После этого сработает блок doOnSuccess, где вы можете выполнить логирование успешного результата.
Когда срабатывает doOnSuccess:
Только при успешном ответе от сервера (код 2xx).
Если запрос завершился ошибкой (например, сервер вернул 4xx или 5xx), doOnSuccess не будет вызван, и поток сразу перейдет к обработке ошибки.
Пример для разъяснения:
Запрос завершился с ошибкой (например, статус 500).

Мы попадаем в блок onStatus(HttpStatus::isError, response -> {...}).
Логируем ошибку, десериализуем ее.
Блок doOnSuccess не будет вызван, потому что мы не получаем успешный ответ.
Запрос завершился успешно (например, статус 200).

Мы десериализуем успешный ответ с помощью bodyToMono(DepositResponse.class).
После этого вызывается doOnSuccess, и логируется успешный ответ.
Таким образом, ошибки никогда не попадут в doOnSuccess, так как этот блок вызывается только в случае успешного ответа от сервера.
